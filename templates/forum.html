{% extends 'base.html' %}

{% block title %}Codaí - Fórum{% endblock %}
{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/forum.css') }}">
{% endblock %}

{% block content %}
    <div class="forum-main">
    <section class="forum-hero">
      <h1>Fórum Codai</h1>
      <p>
        Este espaço foi criado especialmente para quem está começando ou aprimorando seus conhecimentos em programação.
        Compartilhe dúvidas, aprendizados e experiências com outros alunos e desenvolvedores. Aqui, todos estão aprendendo juntos!
      </p>

      <!-- BARRA DE INDICADORES -->
      <div class="forum-dots">
        <span></span><span></span><span></span><span></span><span></span>
      </div>

      <a href="{{ url_for('forum.create_post') }}" class="forum-btn">Faça uma postagem</a>
      <input type="text" placeholder="Digite aqui a sua dúvida, experiência ou descoberta..." class="forum-input">
    </section>

    <!-- FILTROS POR CATEGORIA -->
    <section class="forum-filters">
      <h3>Filtrar por categoria:</h3>
      <div class="category-filters">
        <a href="{{ url_for('forum.index') }}" class="filter-btn {% if not selected_category %}active{% endif %}">Todas</a>
        {% for category in categories %}
        <a href="{{ url_for('forum.posts_by_category', category_id=category.id) }}"
           class="filter-btn {% if selected_category and selected_category.id == category.id %}active{% endif %}"
           data-color="{{ category.color|default('#ccc') }}">
          #{{ category.name }}
        </a>
        {% endfor %}
      </div>
    </section>

    <!-- POSTAGENS -->
    <section class="forum-posts">
      <h2>Últimas postagens</h2>
      <div class="forum-grid">
        {% for post in posts %}
        <div class="forum-card {% if post.is_highlighted %}highlight{% endif %}">
          <img src="/static/image/account_circle_24dp_FFFFFF_FILL0_wght400_GRAD0_opsz24.svg" alt="Usuário">
          <div class="forum-card-content">
            <h3><a href="{{ url_for('forum.view_post', post_id=post.id) }}">{{ post.title }}</a></h3>
            <p>{{ post.content[:150] }}{% if post.content|length > 150 %}...{% endif %}</p>
            <div class="post-meta">
              <span class="forum-tag" data-color="{{ post.category.color }}">#{{ post.category.name }}</span>
              <span class="post-author">por {{ post.user.nome }}</span>
              <span class="post-date">{{ post.created_at.strftime('%d/%m/%Y') }}</span>
              <span class="comments-count">{{ post.comments|length }} comentário(s)</span>
            </div>
          </div>
        </div>
        {% endfor %}
        
        {% if not posts %}
        <div class="no-posts">
          <p>Nenhum post encontrado. Seja o primeiro a compartilhar algo!</p>
          <a href="{{ url_for('forum.create_post') }}" class="forum-btn">Criar primeiro post</a>
        </div>
        {% endif %}
      </div>
    </section>
  </div>
{% endblock %}

